---
title: "Invalid schema for function 'guidance_web_qna': One or more parameters are not of the expected type 'object' or 'boolean'. Please check the types for 'query_item', 'answer', and 'query_variations'."
provider: "azure-openai"
provider_icon: "/file.svg"
solved: true
slug: "validation-schema-error-9552"
---

## Raw Error Text

```text
Invalid schema for function 'guidance_web_qna': [{'query_item': {'description': "the 'query_item is for a question", 'type': 'string'}, 'answer': {'type': 'string', 'description': "The 'answer' parameter represents the actual answer of the business present in the context which is scrapped textual data"}, 'query_variations': {'type': 'array', 'items': {'description': "The 'query_variations' parameter represents the unique variations of the query formed above so as to cover various cases when an actual customer of the business asks questions"}}}] is not of type 'object', 'boolean'
```

## Reason

The 400 Bad Request error "Invalid schema for function 'guidance_web_qna'" in the Azure OpenAI API occurs because the `parameters` field in your function definition does not conform to the expected JSON Schema format. 

Key reasons for this failure include:
1. **Root Schema Type Mismatch**: The error explicitly states that the provided schema `[...]` is not of type 'object' or 'boolean'. This indicates that the parameters were passed as an **array** (wrapped in square brackets) instead of a single JSON **object**. In the OpenAI/Azure OpenAI specification, the `parameters` field must be an object representing the root of a JSON schema.
2. **Data Type Mismatch**: There is a discrepancy between the data types defined in your request and what the API expects. For instance, `query_item` and `answer` are expected to be strings, while `query_variations` is expected to be an array. If these are incorrectly defined (e.g., as objects instead of strings), the validation fails.
3. **Invalid Structure and Nesting**: The schema structure likely violates JSON Schema standards. Common issues include missing the `"type": "object"` declaration at the root of the parameters, incorrect nesting of `properties`, or missing required items in the `items` field of an array schema.
4. **Strict Mode Constraints**: If using Structured Outputs or `strict: true`, the API enforces additional constraints, such as prohibiting `additionalProperties: true` and requiring all properties to be listed in the `required` array.

## Solution
To resolve the "Invalid schema" error for the 'guidance_web_qna' function, follow these remediation steps:
1. **Verify the Root Structure**: Ensure that the `parameters` field is a JSON object, not an array. It should look like this:
   ```json
   "parameters": {
     "type": "object",
     "properties": { ... },
     "required": [ ... ]
   }
   ```
2. **Correct Data Types**: Explicitly define the types for each property within the schema. 
   - Set `query_item` and `answer` to `"type": "string"`.
   - Set `query_variations` to `"type": "array"` and ensure it includes an `items` object describing the array elements.
3. **Review API Documentation**: Consult the Azure OpenAI documentation to ensure you are using the correct JSON Schema version (typically Draft 4 or 2020-12 depending on the feature) and that all keys like `properties` and `required` are at the correct nesting level.
4. **Validate Your Payload**: Before sending the request, use a JSON Schema validator (such as `openapi-spec-validator` or an online tool like JSONSchema.net) to verify that your `parameters` object is valid JSON Schema.
5. **Check for Unsupported Fields**: If you are using "Strict" mode, remove unsupported fields such as `default` values or `additionalProperties: true`.

## Suggested Links
- [https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400](https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400)
- [https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/structured-outputs?tabs=rest](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/structured-outputs?tabs=rest)
- [https://learn.microsoft.com/en-us/answers/questions/1479386/azure-openai-api-calling-issue](https://learn.microsoft.com/en-us/answers/questions/1479386/azure-openai-api-calling-issue)
- [https://community.openai.com/t/how-can-i-write-a-post-request-for-azure-openai-that-uses-structured-output/898569](https://community.openai.com/t/how-can-i-write-a-post-request-for-azure-openai-that-uses-structured-output/898569)
- [https://community.openai.com/t/azure-open-ai-assistant-api-connection-error/662198](https://community.openai.com/t/azure-open-ai-assistant-api-connection-error/662198)
- [https://learn.microsoft.com/en-us/answers/questions/1634484/how-to-validate-openapi-json-spec-and-avoid-errors](https://learn.microsoft.com/en-us/answers/questions/1634484/how-to-validate-openapi-json-spec-and-avoid-errors)
- [https://community.openai.com/t/invalid-schema-error-in-function-using-arrays/454504](https://community.openai.com/t/invalid-schema-error-in-function-using-arrays/454504)
