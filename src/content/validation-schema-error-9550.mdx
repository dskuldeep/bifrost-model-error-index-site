---
title: "Invalid schema for function \"guidance_web_qna\": One or more parameters are not of the expected type \"object\" or \"boolean\". Please check the types for \"query_item\", \"answer\", and \"query_variations\"."
provider: "azure-openai"
provider_icon: "/file.svg"
solved: true
slug: "validation-schema-error-9550"
---

## Raw Error Text

```text
Invalid schema for function "guidance_web_qna": [{"query_item": {"description": "the "query_item" is for single question", "type": "string"}, "answer": {"type": "string", "description": "The "answer" parameter represents the actual answer of the business present in the context which is scrapped textual data"}, "query_variations": {"type": "array", "items": {"description": "The "query_variations" parameter represents the unique variations of the query formed above so as to cover various cases when an actual customer of the business asks questions"}}}] is not of type "object", "boolean"
```

## Reason

The error occurs because the schema definition provided for the function `guidance_web_qna` is incorrectly structured as a JSON array `[...]` instead of a JSON object or boolean. In the Azure OpenAI and OpenAI API specifications, the `parameters` field for a function must be a valid JSON Schema object. 

Key reasons for this error include:
1. **Incorrect JSON Schema Type**: The error message explicitly states the schema is not of type "object" or "boolean". In your request, the schema definition was wrapped in square brackets, making it an array, which the API validator does not accept for function parameters.
2. **Invalid Field Definitions**: The schema may contain unsupported properties. When using specific features like Structured Outputs, certain field properties (such as default values) are not supported and will trigger validation failures.
3. **Mismatch in Expected Parameters**: The parameters provided do not align with the JSON Schema draft-07 or the specific format required by the endpoint. This often happens if the `type`, `properties`, and `required` fields are not correctly nested within a top-level object.
4. **Version Compatibility**: API versioning (e.g., using an older preview version of the Azure OpenAI API) or outdated library versions can lead to strict validation failures if the schema structure does not match the specific version's requirements.

## Solution
To resolve the 400 Status Error and correct the validation schema, follow these steps:
1. **Correct the Schema Structure**: Ensure the `parameters` field is a JSON object. It should follow this structure:

```json
{
  "type": "object",
  "properties": {
    "query_item": { "type": "string", "description": "..." },
    "answer": { "type": "string", "description": "..." },
    "query_variations": {
      "type": "array",
      "items": { "type": "string", "description": "..." }
    }
  },
  "required": ["query_item", "answer", "query_variations"]
}
```
2. **Verify API Keys and Credentials**: Ensure your API key is valid, has not expired, and matches the credentials in the Azure OpenAI portal or OpenAI Developer Dashboard.
3. **Inspect Headers and Content Type**: Confirm that the `Content-Type` header is set to `application/json` and that all required authentication headers (like `api-key` or `Authorization`) are present.
4. **Handle Version Compatibility**: Check that the `api-version` parameter in your request URL is compatible with the features you are using (e.g., `2024-08-01-preview` or later for advanced structured output features).
5. **Check Rate Limiting and Payload Size**: Ensure the total size of your schema and prompt does not exceed the model's context limit or the API's maximum request size.
6. **Enable Client Logging**: Use SDK-level logging (such as setting the logging level to `DEBUG` in the Python SDK) to inspect the raw JSON payload being sent to Azure OpenAI to ensure no unexpected transformations are occurring before the request hits the wire.

## Suggested Links
- [https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/function-calling](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/function-calling)
- [https://platform.openai.com/docs/guides/function-calling](https://platform.openai.com/docs/guides/function-calling)
- [https://json-schema.org/understanding-json-schema/reference/object](https://json-schema.org/understanding-json-schema/reference/object)
