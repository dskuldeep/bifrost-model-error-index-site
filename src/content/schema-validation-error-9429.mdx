---
title: "Invalid schema for function 'matching_auto_reply': 'float' is not valid under any of the given schemas"
provider: "azure-openai"
provider_icon: "/file.svg"
solved: true
slug: "schema-validation-error-9429"
---

## Reason

The `400 Bad Request` error in the Azure OpenAI API, specifically the **Invalid schema for function** error, occurs when the JSON schema provided in the `functions` or `tools` parameter does not conform to the expected specification. 

Key reasons for this failure include:
1.  **Data Type Mismatch (The 'float' issue)**: The error message `'float' is not valid under any of the given schemas` is a common pitfall. JSON Schema (the standard used by OpenAI) does not recognize `float` as a valid primitive type. It supports `string`, `number`, `integer`, `object`, `array`, `boolean`, and `null`. Using `type: "float"` instead of `type: "number"` will trigger this validation error.
2.  **Invalid or Missing Schema**: The JSON schema may be missing required structural items. For example, if a property is defined as an `array`, it must include an `items` object to define the contents of that array.
3.  **Incorrect Request Payload**: The overall payload sent to the API may fail validation if it contains unrecognized request arguments, incorrect formatting, or is missing fields required by the API version being used.
4.  **Model-Specific Parameters**: Different OpenAI models (such as GPT-4 Turbo vs. GPT-4o) have specific parameter constraints. For instance, substituting `max_tokens` with `max_completion_tokens` on models that do not support the latter can result in a 400 error.
5.  **Header and Content-Type Issues**: If the `Content-Type` header is not explicitly set to `application/json`, the server may fail to parse the incoming request, leading to a schema-related error.

## Solution
To resolve the `400` status error and fix the invalid function schema, follow these remediation steps:
1.  **Match Valid Data Types**: Locate the parameter in your function definition that uses `"type": "float"` and change it to `"type": "number"`. Use `number` for any decimal or floating-point values.
2.  **Validate the JSON Schema**: Ensure the function definition is a valid JSON Schema. Verify that every `object` has a `properties` field and every `array` has an `items` field defined. You can use an online JSON Schema validator to test your `parameters` block.
3.  **Correct Request Payload**: Double-check the structure of your API request. Ensure that the `tools` or `functions` array is correctly formatted and that all mandatory fields for the specific API endpoint are present.
4.  **Use Correct Model Parameters**: Verify the documentation for the specific model deployment you are using. Ensure you are utilizing the correct token limit parameters (e.g., `max_tokens` vs. `max_completion_tokens`) and that your model supports tool calling.
5.  **Check Headers and Content-Type**: Ensure your HTTP client is configured to send the `Content-Type: application/json` header with every request to the Azure OpenAI endpoint.

## Suggested Links
- [https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400](https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400)
- [https://github.com/instructor-ai/instructor/issues/961](https://github.com/instructor-ai/instructor/issues/961)
- [https://learn.microsoft.com/en-us/answers/questions/1479386/azure-openai-api-calling-issue](https://learn.microsoft.com/en-us/answers/questions/1479386/azure-openai-api-calling-issue)
- [https://github.com/Azure/azure-sdk-for-java/blob/main/sdk/openai/azure-ai-openai/TROUBLESHOOTING.md](https://github.com/Azure/azure-sdk-for-java/blob/main/sdk/openai/azure-ai-openai/TROUBLESHOOTING.md)
- [https://community.openai.com/t/azure-open-ai-assistant-api-connection-error/662198](https://community.openai.com/t/azure-open-ai-assistant-api-connection-error/662198)
- [https://json-schema.org/understanding-json-schema/reference/numeric](https://json-schema.org/understanding-json-schema/reference/numeric)
- [https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/function-calling](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/function-calling)
