---
title: "Expected last role to be user but got RoleEnum.system"
provider: "mistral-ai"
provider_icon: "/file.svg"
solved: true
slug: "role-assignment-error-9402"
---

## Reason

The error **"Expected last role to be user but got RoleEnum.system"** indicates a validation failure during the chat completion request. Mistral AI enforces strict message sequencing to ensure the model has a clear prompt to act upon. 

Key reasons for this error include:
1. **Invalid Role Sequence**: The Mistral API requires that the final message in the `messages` array be a role that prompts an action, typically a `user` or a `tool`. A `system` role is reserved for high-level instructions and is not permitted as the terminal message.
2. **400 Bad Request Status**: This status code indicates that the server cannot process the request due to a client-side error. This often involves invalid syntax, such as placing a `system` message at the end of the payload.
3. **Parameter Incompatibility**: The error can also be triggered if the request includes unsupported parameters or if the configuration of the API endpoint does not align with the provided message structure (e.g., using tool-related roles without defining tools).

## Solution
To resolve the 400 status error and correctly format your Mistral AI request, follow these steps:
1. **Update the Last Message Role**: Verify that the last object in your `messages` array has the `role` set to `user`. The API expects the conversation to end with a user prompt or a tool response.
2. **Reorder the Message Sequence**: Ensure that any `system` messages are placed at the beginning of the `messages` array. System messages provide the context for the model's behavior and should precede user and assistant interactions.
3. **Cleanse Request Parameters**: Review the API payload and remove any extra or disallowed parameters. Only include fields supported by the specific Mistral model and endpoint you are targeting.
4. **Validate Request Syntax**: Double-check that all headers (e.g., `Authorization`) and the JSON body structure conform to the requirements specified in the Mistral AI documentation.
5. **Verify Role Fields**: Ensure that role fields are accurately typed as `user`, `assistant`, `system`, or `tool`, and that they align with the expected enum values defined by the provider.

## Suggested Links
- [https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400](https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400)
- [https://community.crewai.com/t/crewai-on-mistral-api-error/1559](https://community.crewai.com/t/crewai-on-mistral-api-error/1559)
- [https://community.openai.com/t/request-failed-with-status-code-400/39242](https://community.openai.com/t/request-failed-with-status-code-400/39242)
- [https://community.openai.com/t/error-400-already-has-an-active-run/930753](https://community.openai.com/t/error-400-already-has-an-active-run/930753)
- [https://forum.cloudron.io/topic/11826/using-mistral-api-seems-broken-on-cloudron](https://forum.cloudron.io/topic/11826/using-mistral-api-seems-broken-on-cloudron)
- [https://github.com/mistralai/client-python/blob/main/README.md](https://github.com/mistralai/client-python/blob/main/README.md)
- [https://github.com/langchain-ai/langchain/issues/23703](https://github.com/langchain-ai/langchain/issues/23703)
- [https://github.com/microsoft/autogen/issues/991](https://github.com/microsoft/autogen/issues/991)
- [https://community.meraki.com/t5/Developers-APIs/API-Looping-createOrganizationAdmin-returns-400-Bad-Request/m-p/239525](https://community.meraki.com/t5/Developers-APIs/API-Looping-createOrganizationAdmin-returns-400-Bad-Request/m-p/239525)
- [https://docs.mistral.ai/api/](https://docs.mistral.ai/api/)
- [https://docs.mistral.ai/capabilities/chat/](https://docs.mistral.ai/capabilities/chat/)
