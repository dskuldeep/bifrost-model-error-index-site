---
title: "Input data is not of the expected format. Please ensure that the data is structured correctly and try again."
provider: "openai"
provider_icon: "/logos/openai.png"
solved: true
slug: "data-format-error-9040"
---

## Raw Error Text

```text
'"[{\\"role\\":\\"system\\",\\"content\\":\\"You will now enter \'Note querying\' mode. Given the complete notes about an entity, answer the question for the user. All notes with the same number as the entity are tagged to the entity, so notes-1 are about entity-1, notes-2 are about entity-2, and so on. Your answer should be crisp, accurate, and helpful.\\\\n\\\\n    Ensure the output is formatted for clarity and ease of reading, with a focus on usability and immediate access to key information.\\\\n    \\\\n    Example input -\\\\n    \\\\n    {Entity-1: Priyanka Mehta,\\\\n    \\\\n    Notes-1: - Dad is a CA - family originally from Ambd Surat (?) and filled with Doctors (Dr. Mehtas\\u2019)\\\\n    \\\\n    - Born and brought up in Mumbai, studied in the US\\\\n    - Stays in Koramangala with hubby\\\\n    - ICSE schooling till 10th and IB till 12th (shifted to Ambani after a certain grade)\\\\n    - Has a 25-year old sister, who has never dated and is insecure about that\\\\n    - Met Abhijit at Edutok Learning in 2018-19 and married him\\\\n    - Abhijit is a rare Marwadi running an edtech non-profit Spaceship Learning; he helps ground Priyanka away from VC bubbles\\\\n    - Carefully use the word impact as it has a diff meaning in the household\\\\n    - Does not give a lot of thought to dressing up\\\\n    - Investing role is the convergence of all the things she likes - meeting people for fun and learning - she does not derive joy from investing necessarily but all things preceding it\\\\n    - Earlier felt founders have to have high EQ but has since so much and learnt that founders need some bit of intimidation\\\\n    - Cares about the founder\\u2019s obsession about the user; remembers all such anecdotes\\\\n    - Bday: 27 September, 1991\\\\n    \\\\n    Question: Priyanka just got promoted to a Healthcare Partner at Sequoia Capital. How do I wish her on Whatsapp?}\\\\n    \\\\n    Example output: {\\\\\\"Hey Priyanka! Congratulations on your recent promotion at Sequoia Capital! Despite not being a doctor in your family, you will be enabling the creation and prosperity of several others. Wish you all the best!\\\\\\"}\\\\n    \\\\n    Now, take a deep breath, think step by step and execute.\\\\n\\\\n\\\\nEntity 1 - Mind dump \\\\n\\\\n All Notes about Mind dump \\\\n\\\\n  Note 1.1 - hello \\\\n$\\\\n\\\\n\\\\nEntity 1 - Team Meeting for Testing \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Team Meeting for Testing\\\\nDescription \\\\nAttendees - \\\\nOrganizer - siddharth@getmili.ai \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 2 - Dezerv x MIli \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Dezerv x MIli\\\\nDescription \\\\nAttendees - ankitgupta@dezerv.in\\\\narnab.dey@dezerv.in\\\\nchirag@getmili.ai\\\\nsiddharth@getmili.ai\\\\nvennela@getmili.ai\\\\nanimesh@getmili.ai\\\\nOrganizer - chirag@getmili.ai \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 3 - New meet \\\\n\\\\n All Notes about Calendar Event \\\\nTitle New meet\\\\nDescription \\\\nAttendees - chirag@getmili.ai\\\\nsiddharth@getmili.ai\\\\nOrganizer - siddharth@getmili.ai \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 4 - Cancel Trial Trading View \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Cancel Trial Trading View\\\\nDescription \\\\nAttendees - \\\\nOrganizer - siddharth@getmili.ai \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 5 - Vishnu/Siddharth: Catchup \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Vishnu/Siddharth: Catchup\\\\nDescription \\\\nAttendees - siddharth@getmili.ai\\\\nvishnu@shortloop.dev\\\\nOrganizer - vishnu@shortloop.dev \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 6 - Bulls <> Mohit \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Bulls <> Mohit\\\\nDescription <p><a href=\\\\\\"https://meet.google.com/obu-hjri-bmj\\\\\\" rel=\\\\\\"noopener noreferrer\\\\\\" target=\\\\\\"_blank\\\\\\">https://meet.google.com/obu-hjri-bmj</a></p>\\\\nAttendees - mohit@cloudchef.co\\\\nsiddharth@getmili.ai\\\\nOrganizer - siddharth@getmili.ai \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 7 - Catch-up \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Catch-up\\\\nDescription \\\\nAttendees - chirag@getmili.ai\\\\nmsg4pranav@gmail.com\\\\npranav@paragont.com\\\\nsiddharth@getmili.ai\\\\nOrganizer - chirag@getmili.ai \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 8 - Mili AI - Formation questionnaire \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Mili AI - Formation questionnaire\\\\nDescription \\\\nAttendees - vennela@getmili.ai\\\\nchirag@getmili.ai\\\\nsiddharth@getmili.ai\\\\nanil@inventuslaw.com\\\\nchirayu@inventuslaw.com\\\\nOrganizer - inventuslaw.com_s2qnefddr56lblumh43nos9gks@group.calendar.google.com \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 9 - Bulia <> Mohit \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Bulia <> Mohit\\\\nDescription \\\\nAttendees - siddharth@getmili.ai\\\\nmohit@cloudchef.co\\\\nOrganizer - siddharth@getmili.ai \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 10 - Bulls Out For Parth Wedding \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Bulls Out For Parth Wedding\\\\nDescription \\\\nAttendees - animesh@getmili.ai\\\\nchirag@getmili.ai\\\\nsiddharth@getmili.ai\\\\nvennela@getmili.ai\\\\nOrganizer - siddharth@getmili.ai \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 11 - Secret Event - Password = Chirag Gandhi \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Secret Event - Password = Chirag Gandhi\\\\nDescription \\\\nAttendees - \\\\nOrganizer - siddharth@getmili.ai \\\\n\\\\n\\\\n\\\\n------------------------\\\\n\\\\nEntity 12 - Mili Huddle \\\\n\\\\n All Notes about Calendar Event \\\\nTitle Mili Huddle\\\\nDescription <html><head></head><body><p>\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500\\u2500<br/>Chirag Gandhi is inviting you to a scheduled Zoom meeting.<br/><br/>Join Zoom Meeting<br/>https://us06web.zoom.us/j/89111957191?pwd=k8CmodPWZ16Xz8ILPxprxXabKit5Zp.1<br/><br/>Meeting ID: 891 1195 7191<br/>Passcode: 448401<br/><br/>---<br/><br/>One tap mobile<br/> 13092053325,,89111957191"' is not of type 'array' - 'messages'
```

## Reason

The error message `'...' is not of type 'array' - 'messages'` indicates a schema validation failure. OpenAI's Chat Completions API requires the `messages` parameter to be a JSON array of objects, but the raw log shows that a single string (a stringified JSON array) was passed instead. This typically occurs when data is double-serialized or passed as a raw string rather than a native data structure.

General causes for a 400 Bad Request include:
1. **Incorrect Request Format**: The most common cause in this instance. The API server expects a specific structure (e.g., an array for 'messages'), and receiving a different data type (like a string) causes the request to be rejected immediately.
2. **Invalid API Key**: The key may be incorrect, expired, or may contain hidden whitespace characters introduced during a copy-paste operation.
3. **Rate Limiting and Throttling**: If your organization has exceeded the allowed number of requests per minute (RPM) or tokens per minute (TPM), the server will return a 400 or 429 error.
4. **Configuration or Parameter Issues**: Missing required parameters, such as `model`, or providing invalid values for parameters like `temperature` or `max_tokens` can trigger this error.
5. **Account and Billing Status**: If the OpenAI account has an exhausted credit balance or an expired payment method, API requests will fail with a 400-level error.
6. **Network Issues**: Significant packet loss or high latency can occasionally lead to malformed requests reaching the server.

## Solution
To resolve the 400 status error and the specific 'not of type array' failure, follow these steps:
1. **Fix Data Serialization**: Ensure that the `messages` parameter is passed as a native array (e.g., a List in Python or an Array in JavaScript) rather than a JSON-encoded string. If you are using an SDK, do not manually stringify the messages object before passing it to the library.
2. **Verify API Key**: Confirm your API key is active in the OpenAI dashboard. Re-copy the key to ensure no hidden characters or trailing spaces are present in your environment variables.
3. **Adhere to Rate Limits**: Check your usage tier in the OpenAI account settings and implement backoff logic or request queuing if you are hitting rate limits.
4. **Validate Request Parameters**: Cross-reference your request body with the official OpenAI API documentation. Ensure all required fields (like `model` and `messages`) are present and use the correct data types.
5. **Inspect Network Traffic**: Use tools like Postman, cURL, or network interceptors to verify the exact payload being sent. Ensure headers, specifically `Content-Type: application/json`, are correctly set.
6. **Review Billing and Account Status**: Visit the OpenAI Billing settings to ensure you have a valid payment method on file and sufficient credits to make requests.

## Suggested Links
- [https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400](https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400)
- [https://community.openai.com/t/troubleshooting-api-integration-with-openais-language-model/627096](https://community.openai.com/t/troubleshooting-api-integration-with-openais-language-model/627096)
- [https://community.openai.com/t/request-failed-with-status-code-400/39242/25](https://community.openai.com/t/request-failed-with-status-code-400/39242/25)
- [https://community.openai.com/t/i-am-receiving-an-error-status-code-400/351121](https://community.openai.com/t/i-am-receiving-an-error-status-code-400/351121)
- [https://notegpt.io/blog/openai-api-key-not-working](https://notegpt.io/blog/openai-api-key-not-working)
- [https://help.openai.com/en/articles/6897213-openai-library-error-types-guidance](https://help.openai.com/en/articles/6897213-openai-library-error-types-guidance)
- [https://community.openai.com/t/getting-400-response-with-already-working-code/509212](https://community.openai.com/t/getting-400-response-with-already-working-code/509212)
- [https://platform.openai.com/docs/api-reference/chat/create](https://platform.openai.com/docs/api-reference/chat/create)
