---
title: "Invalid input: The provided input does not meet the expected format or values. Please consult the API reference for more information."
provider: "openai"
provider_icon: "/logos/openai.png"
solved: true
slug: "input-validation-error-9162"
---

## Raw Error Text

```text
"$.tool_choice" is invalid. Please check the API reference: https://platform.openai.com/docs/api-reference.
```

## Reason

The OpenAI API returns a `400 Bad Request` error when the `tool_choice` parameter is incorrectly configured in the request payload. This validation failure typically occurs due to the following reasons:
1. **Invalid Parameter Value**: The `tool_choice` field expects specific, case-sensitive values. Valid options include the strings `"none"`, `"auto"`, or `"required"`. Alternatively, it can be an object specifying a specific tool. If a value outside of these formats is provided, the API will reject the request.
2. **Dependency Mismatch**: Providing a `tool_choice` (especially `"required"` or a specific tool object) without also providing a populated `tools` array in the request body will trigger this error.
3. **Function Name Mismatch**: When specifying a particular function via an object (e.g., `{"type": "function", "function": {"name": "my_function"}}`), the name must exactly match a function defined within the `tools` list.
4. **Invalid Request Syntax or Missing Properties**: The error can be a result of broader formatting issues, such as hidden characters, incorrect data types, or missing mandatory properties. For example, some users encounter 400 errors when the `content` property is missing from message objects where it is required.
5. **Model-Specific Constraints**: Tool calling and the `tool_choice` parameter are only supported by specific chat models (such as `gpt-4o`, `gpt-4-turbo`, or `gpt-3.5-turbo`). Attempting to use these parameters with legacy models or non-chat completion endpoints will result in a validation error.

## Solution
To resolve the 400 status error related to `tool_choice`, follow these remediation steps:
1. **Verify tool_choice Syntax**: Ensure the value provided to `tool_choice` matches the API's expected schema. It should be one of the following:
    - `"none"`: The model will not call a tool and instead generates a message.
    - `"auto"`: The model can pick between generating a message or calling one or more tools.
    - `"required"`: The model is forced to call one or more tools.
    - **Object**: A specific tool reference, e.g., `{"type": "function", "function": {"name": "my_function"}}`.
2. **Check the tools Array**: Ensure that your request includes a `tools` parameter containing the definitions for the functions the model can call. If `tool_choice` specifies a function name, that name must exist in the `tools` array.
3. **Review Required Parameters**: Confirm that all required fields for the Chat Completions API are present. This includes the `model` and `messages` fields. Ensure that each message in the `messages` array has the necessary `role` and `content` properties.
4. **Adhere to Model-Specific Constraints**: Use a model that explicitly supports tool calling. Consult the OpenAI model documentation to verify compatibility.
5. **Verify API Keys and Permissions**: Confirm that your API key is valid, has not expired, and has the permissions required to access the specific model being called.
6. **Inspect Data Payload Size**: Ensure the total request size does not exceed the model's maximum context length or the API's payload size limits.
7. **Check Rate Limiting**: Ensure you are not exceeding your account's rate limits (TPM/RPM), as some libraries may surface rate limit issues as general 400 errors if not handled specifically.

Consult the OpenAI API reference to ensure all parameters are correctly formatted for the version of the API you are using.

## Suggested Links
- [https://platform.openai.com/docs/api-reference/chat/create#chat-create-tool_choice](https://platform.openai.com/docs/api-reference/chat/create#chat-create-tool_choice)
- [https://platform.openai.com/docs/guides/function-calling](https://platform.openai.com/docs/guides/function-calling)
- [https://platform.openai.com/docs/models](https://platform.openai.com/docs/models)
- [https://platform.openai.com/docs/api-reference](https://platform.openai.com/docs/api-reference)
