---
title: "Additional properties are not allowed ('functions' was unexpected) - 'messages.0'"
provider: "azure-openai"
provider_icon: "/file.svg"
solved: true
slug: "invalid-property-error-9278"
---

## Reason

The **400 Bad Request** error with the message `Additional properties are not allowed ('functions' was unexpected) - 'messages.0'` occurs when the `functions` property is incorrectly placed inside a message object within the `messages` array, rather than at the top level of the request body.

Key factors contributing to this error include:
1.  **Schema Violation**: The Azure OpenAI API schema for the `messages` array allows only specific properties such as `role`, `content`, `name`, and `tool_call_id`. Including a `functions` property inside `messages[0]` (the first element of the array) violates this schema.
2.  **Incorrect Payload Nesting**: In the Chat Completions API, the `functions` (or `tools`) parameter must be a peer to the `messages` array, not a child of it.
3.  **API Version Deprecation**: While older versions of the API supported the `functions` parameter, modern versions (starting with `2023-12-01-preview`) have deprecated `functions` and `function_call` in favor of the `tools` and `tool_choice` structure. Using the old property in an incorrect location or with an incompatible API version triggers validation failures.

## Solution
To resolve this error, you must align your request payload with the expected JSON schema by moving or updating the `functions` property.

Follow these remediation steps:
1.  **Relocate the Property**: Ensure the `functions` definition is at the root of your JSON request body. 
    - **Incorrect**: `{"messages": [{"role": "user", "content": "...", "functions": [...]}]}`
    - **Correct**: `{"messages": [{"role": "user", "content": "..."}], "functions": [...]}`
2.  **Migrate to Tools (Recommended)**: If you are using API version `2023-12-01-preview` or later, transition from `functions` to `tools` to ensure long-term compatibility. The structure remains similar, but the key name and nesting change slightly.
3.  **Validate API Version and Endpoint**: Confirm that the `api-version` parameter in your request URL matches the feature set you are attempting to use. Use a stable version like `2024-02-01` or later for broad tool support.
4.  **Review Client SDK Implementation**: If using an SDK (Python, .NET, or JS), ensure you are passing the functions/tools as a separate argument in the `.create()` method rather than appending them to the message list objects manually.
5.  **Audit the Messages Array**: Strip any non-standard fields from your message objects. Only `role`, `content`, and metadata required for tool responses (like `tool_calls` or `tool_call_id`) should be present.

## Suggested Links
- [https://github.com/Azure/azure-sdk-for-net/issues/43953](https://github.com/Azure/azure-sdk-for-net/issues/43953)
- [https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400](https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400)
- [https://github.com/Azure/azure-sdk-for-js/issues/27039](https://github.com/Azure/azure-sdk-for-js/issues/27039)
- [https://learn.microsoft.com/en-us/answers/questions/1479386/azure-openai-api-calling-issue](https://learn.microsoft.com/en-us/answers/questions/1479386/azure-openai-api-calling-issue)
- [https://community.openai.com/t/how-can-i-write-a-post-request-for-azure-openai-that-uses-structured-output/898569](https://community.openai.com/t/how-can-i-write-a-post-request-for-azure-openai-that-uses-structured-output/898569)
- [https://learn.microsoft.com/en-us/azure/ai-services/openai/references/on-your-data](https://learn.microsoft.com/en-us/azure/ai-services/openai/references/on-your-data)
- [https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/function-calling](https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/function-calling)
