---
title: "Invalid schema for response_format 'Vitals': In context=('properties', 'body_condition_score', 'anyOf', '0'), 'minimum' is not permitted."
provider: "openai"
provider_icon: "/logos/openai.png"
solved: true
slug: "schema-validation-error-9427"
---

## Reason

The OpenAI API returns a `400 Bad Request` error when the server cannot process a request due to client-side issues. In this specific case, the error is caused by a schema validation failure within the `response_format` parameter.

**Unsupported JSON Schema Keywords**
OpenAI's Structured Outputs feature supports only a specific subset of the JSON Schema standard to ensure efficient constrained decoding. Many common validation keywords are **not permitted** when using `strict: true` or `type: "json_schema"`. These include:
1. Numerical constraints: `minimum`, `maximum`, `multipleOf`.
2. String constraints: `minLength`, `maxLength`, `pattern`, `format`.
3. Array constraints: `minItems`, `maxItems`, `uniqueItems`.
4. Logical/Conditional keywords: `allOf`, `if`, `then`, `else`, and `default` values.

In this instance, the error explicitly flags that `'minimum'` is not permitted within the `anyOf` context for the `body_condition_score` property.

**Additional Common Causes for 400 Errors**
1. **Malformed Request Syntax**: The JSON payload may be improperly formatted or contain incorrect data types (e.g., a string provided for an integer field like `max_tokens`).
2. **Missing Mandatory Fields**: Required API parameters or schema fields may be absent from the request.
3. **Authentication Issues**: The API key might be expired, incorrect, or lack the necessary permissions for the selected model.
4. **Rate Limiting**: The request may have exceeded the organization's rate limits or quotas.
5. **Middleware Misconfiguration**: Issues in communication libraries (e.g., Axios), such as incorrect base URLs or headers, can also trigger this response.

## Solution
To resolve the `Invalid schema` error and general `400 Bad Request` issues, follow these steps:

**1. Remove Prohibited Schema Keywords**
Modify your JSON schema to remove any unsupported validation constraints:
1. Delete keywords like `minimum`, `maximum`, `minLength`, and `pattern`.
2. If constraints are necessary for your application logic, specify them in the `description` field of the property or within the system prompt to guide the model's behavior.

**2. Ensure Compliance with Structured Outputs**
If you are using `strict: true` for guaranteed schema adherence, ensure the following:
1. The root of the schema must be a JSON Schema of `"type": "object"`.
2. All objects in the schema must include `"additionalProperties": false`.
3. Every property defined in an object must be explicitly listed in that object's `"required"` array.
4. Use a compatible model that supports Structured Outputs, such as `gpt-4o-2024-08-06` or `gpt-4o-mini-2024-07-18`.

**3. Validate the Request Payload**
1. Use a JSON linter to verify that the entire request body is syntactically correct.
2. Review the OpenAI API documentation to confirm that all required parameters for the specific endpoint are present and use the correct data types.

**4. Verify API Configuration**
1. Check your API key in the OpenAI Developer Dashboard to ensure it is valid and active.
2. Check your organization's usage limits to ensure you have not reached a rate limit.
3. If using a client library, verify that the `Content-Type` header is set to `application/json` and that the `Authorization` header correctly includes the `Bearer` token.

## Suggested Links
- [https://www.restack.io/p/openai-python-answer-request-failed-400-error-cat-ai](https://www.restack.io/p/openai-python-answer-request-failed-400-error-cat-ai)
- [https://community.openai.com/t/official-documentation-for-supported-schemas-for-response-format-parameter-in-calls-to-client-beta-chats-completions-parse/932422](https://community.openai.com/t/official-documentation-for-supported-schemas-for-response-format-parameter-in-calls-to-client-beta-chats-completions-parse/932422)
- [https://github.com/instructor-ai/instructor/issues/961](https://github.com/instructor-ai/instructor/issues/961)
- [https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400](https://cheatsheet.md/chatgpt-cheatsheet/openai-api-error-axioserror-request-failed-status-code-400)
- [https://community.openai.com/t/api-rejects-valid-json-schema/906163](https://community.openai.com/t/api-rejects-valid-json-schema/906163)
- [https://community.openai.com/t/intermittent-error-an-unexpected-error-occurred-error-code-400-error-message-this-model-does-not-support-specifying-dimensions-type-invalid-request-error-param-none-code-none/955807](https://community.openai.com/t/intermittent-error-an-unexpected-error-occurred-error-code-400-error-message-this-model-does-not-support-specifying-dimensions-type-invalid-request-error-param-none-code-none/955807)
- [https://help.promptitude.io/en/articles/9311026-error-400-using-openai-how-to-fix-it](https://help.promptitude.io/en/articles/9311026-error-400-using-openai-how-to-fix-it)
- [https://platform.openai.com/docs/guides/structured-outputs/supported-schemas](https://platform.openai.com/docs/guides/structured-outputs/supported-schemas)
